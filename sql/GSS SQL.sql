-- Fix AR Customers Open > Over Ships
UPDATE CUST_FORM_INFO 
SET NO_OVER_SHP_QTY = '1'
WHERE REC = '6'

-- Fix Date_Due from incorrect 01/01/1900 date
UPDATE ORDER_HIST_LINE
SET DATE_DUE = DATE_SHIPPED
WHERE ORDER_NO = '0638501' OR ORDER_NO = '0639033'

-- Correct missing INV_History and PO_History (for part Swap to 01)
SELECT * FROM GSS_SWAP_REF
WHERE file_name IN ('LHIST@@@','PHIST@@@') AND TYPE = 'I'

-- Change all reorder qty to 0
UPDATE INVENTORY_MSTR
SET QTY_REORDER = '0' 
WHERE LOCATION = '02'

-- Delete all parts from LOC 02 (after removing from master table, FIXPART8/NF from 1Shot to do the subsequent)
DELETE FROM INVENTORY_MSTR
WHERE LOCATION = '02'
	
DELETE FROM INVENTORY_MST2
WHERE LOCATION = '02'
	
DELETE FROM INVENTORY_MST3
WHERE LOCATION = '02'
	
SELECT * FROM INVENTORY_COST
WHERE LOCN = '02'
	
DELETE FROM INVENTORY_COST
WHERE LOCN = '02'
	
-- To clear up Manufacture to job/stock in locations other than 01
--(Tristan's) Delete "INVENTORY_MSTR" where source_code = 'F' and loc <> '01'
	
DELETE FROM INVENTORY_MSTR
WHERE SOURCE_CODE = 'M' AND LOC <> '01'
	
DELETE FROM INVENTORY_MSTR
WHERE SOURCE_CODE = 'F' AND LOC <> '01'
	
-- Find all parts with either ELBOW or TEE and TANGENT in description
SELECT *
FROM "INVENTORY_MSTR"
WHERE (DESCRIPTION LIKE '%ELBOW%' OR DESCRIPTION LIKE '%TEE%')
AND DESCRIPTION LIKE '%TANGENT%'

-- SORT BY PART ASCENDING
select * from "INVENTORY_MSTR"
WHERE PART LIKE '%3P%'
ORDER BY PART ASC

-- FIND ANY JOB_OP NOT FORMATTED AS DATE
SELECT * FROM JOB_OPERATIONS
WHERE DATE_DUE NOT LIKE '%[0-9]%'

-- WORKING TO FIX THE BAD ENTRIES IN DATE_DUE
select JOB, SUFFIX, SEQ, LMO, PART, UNITS_OPEN, UNITS_COMPLETE, FLAG_CLOSED, DATE_START, DATE_DUE, DATE_COMPLETED from "JOB_OPERATIONS"
WHERE LMO = 'L' AND JOB = '916810'
ORDER BY SUFFIX ASC

-- UPDATE ALL INDIRECT TO WO_DUE = WO_COMPLETED
select JOB, SUFFIX, SEQ, LMO, PART, UNITS_OPEN, UNITS_COMPLETE, FLAG_CLOSED, DATE_START, DATE_DUE, DATE_COMPLETED from "JOB_OPERATIONS"
WHERE LMO = 'L' AND DATE_COMPLETED <> '000000' AND SUFFIX = '23' AND JOB LIKE '%IN%' 

-- UPDATE COUNTRY AND STATE FOR UCT REPORTING
select ORDER_NO, ORDER_LINE, NAME_CUST_SHIP, ADDRESS1_SHIP, ADDRESS2_SHIP, ADDRESS3_SHIP, ADDRESS4_SHIP, ADDRESS5_SHIP, COUNTRY_SHIP from "ORDER_HIST_HEAD"

select ORDER_NO, ORDER_LINE, NAME_CUST_SHIP, ADDRESS1_SHIP, ADDRESS2_SHIP, ADDRESS3_SHIP, ADDRESS4_SHIP, ADDRESS5_SHIP, COUNTRY_SHIP from "ORDER_HIST_LINE"

UPDATE "ORDER_HIST_LINE"
SET STATE_SHIP = 'OR'
WHERE CUSTOMER = '82769'

select * from "CUSTOMER_MASTER"
WHERE (REC = '1' OR REC = '3') 
--AND COUNTRY = ''
--WHERE CUSTOMER = 'W23715'
ORDER BY CUSTOMER ASC

UPDATE "CUSTOMER_MASTER"
SET COUNTRY = 'USA'
WHERE STATE = 'WI'

-- UPDATE ALL 50 STATES USA
UPDATE "CUSTOMER_SHIPTO"
SET COUNTRY_SHIP = 'USA'
WHERE REC = '3'
AND (STATE_SHIP = 'AL' OR STATE_SHIP = 'AK' OR STATE_SHIP = 'AZ' OR STATE_SHIP = 'AR' OR STATE_SHIP = 'CA' OR STATE_SHIP = 'CO' OR STATE_SHIP = 'CT' OR STATE_SHIP = 'DE' OR STATE_SHIP = 'FL' OR STATE_SHIP = 'GA' OR STATE_SHIP = 'HI' OR STATE_SHIP = 'ID' OR STATE_SHIP = 'IL' OR STATE_SHIP = 'IN' OR STATE_SHIP = 'IA' OR STATE_SHIP = 'KS' OR STATE_SHIP = 'KY' OR STATE_SHIP = 'LA' OR STATE_SHIP = 'ME' OR STATE_SHIP = 'MD' OR STATE_SHIP = 'MA' OR STATE_SHIP = 'MI' OR STATE_SHIP = 'MN' OR STATE_SHIP = 'MS' OR STATE_SHIP = 'MO' OR STATE_SHIP = 'MT' OR STATE_SHIP = 'NE' OR STATE_SHIP = 'NV' OR STATE_SHIP = 'NH' OR STATE_SHIP = 'NJ' OR STATE_SHIP = 'NM' OR STATE_SHIP = 'NY' OR STATE_SHIP = 'NC' OR STATE_SHIP = 'ND' OR STATE_SHIP = 'OH' OR STATE_SHIP = 'OK' OR STATE_SHIP = 'OR' OR STATE_SHIP = 'PA' OR STATE_SHIP = 'RI' OR STATE_SHIP = 'SC' OR STATE_SHIP = 'SD' OR STATE_SHIP = 'TN' OR STATE_SHIP = 'TX' OR STATE_SHIP = 'UT' OR STATE_SHIP = 'VT' OR STATE_SHIP = 'VA' OR STATE_SHIP = 'WA' OR STATE_SHIP = 'WV' OR STATE_SHIP = 'WI' OR STATE_SHIP = 'WY');

SELECT * FROM "CUSTOMER_MASTER"
WHERE COUNTRY = '' 
AND (REC = '1' OR REC = '3')
--ORDER BY REC ASC

SELECT * FROM "CUSTOMER_SHIPTO"
WHERE REC = '3' 
--AND COUNTRY_SHIP = '' 
--WHERE STATE_SHIP = 'AL'  AND REC = '3'
ORDER BY STATE_SHIP ASC

-- FILTER BY DATE
SELECT *
FROM "ORDER_HIST_HEAD"
WHERE DATE_SHIPPED > CAST('2023-01-01' AS DATE)

-- UPDATE ORDER_HIST_HEAD COUNTRY = USA
UPDATE "ORDER_HIST_HEAD"
SET COUNTRY = 'USA'
WHERE DATE_SHIPPED > CAST('2023-01-01' AS DATE)
AND (STATE = 'AL' OR STATE = 'AK' OR STATE = 'AZ' OR STATE = 'AR' OR STATE = 'CA' OR STATE = 'CO' OR STATE = 'CT' OR STATE = 'DE' OR STATE = 'FL' OR STATE = 'GA' OR STATE = 'HI' OR STATE = 'ID' OR STATE = 'IL' OR STATE = 'IN' OR STATE = 'IA' OR STATE = 'KS' OR STATE = 'KY' OR STATE = 'LA' OR STATE = 'ME' OR STATE = 'MD' OR STATE = 'MA' OR STATE = 'MI' OR STATE = 'MN' OR STATE = 'MS' OR STATE = 'MO' OR STATE = 'MT' OR STATE = 'NE' OR STATE = 'NV' OR STATE = 'NH' OR STATE = 'NJ' OR STATE = 'NM' OR STATE = 'NY' OR STATE = 'NC' OR STATE = 'ND' OR STATE = 'OH' OR STATE = 'OK' OR STATE = 'OR' OR STATE = 'PA' OR STATE = 'RI' OR STATE = 'SC' OR STATE = 'SD' OR STATE = 'TN' OR STATE = 'TX' OR STATE = 'UT' OR STATE = 'VT' OR STATE = 'VA' OR STATE = 'WA' OR STATE = 'WV' OR STATE = 'WI' OR STATE = 'WY');

-- EXPORT FOR 
SELECT * FROM "CUSTOMER_MASTER"
WHERE (REC = '1' OR REC = '3') AND COUNTRY <> 'USA' AND COUNTRY <> 'SA'
ORDER BY CUSTOMER ASC

-- LOOK FOR BLANKS
SELECT CUSTOMER, ADDRESS1, ADDRESS2, ADDRESS3, ADDRESS4, ADDRESS5
FROM "ORDER_HIST_HEAD"
WHERE DATE_SHIPPED > CAST('2023-01-01' AS DATE) AND COUNTRY = ''
ORDER BY CUSTOMER ASC

UPDATE "ORDER_HIST_HEAD"
SET COUNTRY = 'PHILLIPINES'
WHERE DATE_SHIPPED > CAST('2023-01-01' AS DATE)
AND (CUSTOMER = A12102)

--HIR
SELECT CUSTOMER, COUNTRY, ADDRESS1, ADDRESS2, ADDRESS3, ADDRESS4, ADDRESS5, CITY, STATE
FROM "ORDER_HIST_HEAD"
WHERE DATE_SHIPPED > CAST('2023-01-01' AS DATE) AND COUNTRY = 'HIR'
ORDER BY CUSTOMER ASC
-- (ORDER_HIST_HEAD ALL UPDATED)

-- VENDOR_MASTER
UPDATE "VENDOR_MASTER"
SET COUNTRY = 'USA'
WHERE (REC = '1' OR REC = '2')
AND (STATE = 'AL' OR STATE = 'AK' OR STATE = 'AZ' OR STATE = 'AR' OR STATE = 'CA' OR STATE = 'CO' OR STATE = 'CT' OR STATE = 'DE' OR STATE = 'FL' OR STATE = 'GA' OR STATE = 'HI' OR STATE = 'ID' OR STATE = 'IL' OR STATE = 'IN' OR STATE = 'IA' OR STATE = 'KS' OR STATE = 'KY' OR STATE = 'LA' OR STATE = 'ME' OR STATE = 'MD' OR STATE = 'MA' OR STATE = 'MI' OR STATE = 'MN' OR STATE = 'MS' OR STATE = 'MO' OR STATE = 'MT' OR STATE = 'NE' OR STATE = 'NV' OR STATE = 'NH' OR STATE = 'NJ' OR STATE = 'NM' OR STATE = 'NY' OR STATE = 'NC' OR STATE = 'ND' OR STATE = 'OH' OR STATE = 'OK' OR STATE = 'OR' OR STATE = 'PA' OR STATE = 'RI' OR STATE = 'SC' OR STATE = 'SD' OR STATE = 'TN' OR STATE = 'TX' OR STATE = 'UT' OR STATE = 'VT' OR STATE = 'VA' OR STATE = 'WA' OR STATE = 'WV' OR STATE = 'WI' OR STATE = 'WY')

-- VENDOR MASTER
select * from "VENDOR_MASTER"
WHERE (REC = '1' OR REC = '2')
AND COUNTRY = ''
ORDER BY VENDOR ASC

-- BEFORE DOING ORDER_HIST_LINE, DO ORDER_SHIP_TO
-- HIS
SELECT * FROM "ORDER_SHIP_TO"
WHERE (RECORD_TYPE = 'C' OR RECORD_TYPE = 'B')
ORDER BY ORDER_NO DESC
--TEST OUT A SINGLE ORDER
-- HIS
SELECT ORDER_NO, RECORD_NO, CUSTOMER, COUNTRY_SHIP, ADDRESS_1_SHIP, ADDRESS_2_SHIP, ADDRESS_3_SHIP, ADDRESS_4_SHIP, ADDRESS_5_SHIP, CITY_SHIP, STATE_SHIP  FROM "ORDER_SHIP_TO"
WHERE (RECORD_TYPE = 'C' OR RECORD_TYPE = 'B') AND COUNTRY_SHIP = ''
ORDER BY ORDER_NO ASC

--NOW DO ORDER_HIST_LINE
-- HIS
UPDATE "ORDER_HIST_LINE"
SET COUNTRY_SHIP = 'USA'
WHERE (STATE_SHIP = 'AL' OR STATE_SHIP = 'AK' OR STATE_SHIP = 'AZ' OR STATE_SHIP = 'AR' OR STATE_SHIP = 'CA' OR STATE_SHIP = 'CO' OR STATE_SHIP = 'CT' OR STATE_SHIP = 'DE' OR STATE_SHIP = 'FL' OR STATE_SHIP = 'GA' OR STATE_SHIP = 'HI' OR STATE_SHIP = 'ID' OR STATE_SHIP = 'IL' OR STATE_SHIP = 'IN' OR STATE_SHIP = 'IA' OR STATE_SHIP = 'KS' OR STATE_SHIP = 'KY' OR STATE_SHIP = 'LA' OR STATE_SHIP = 'ME' OR STATE_SHIP = 'MD' OR STATE_SHIP = 'MA' OR STATE_SHIP = 'MI' OR STATE_SHIP = 'MN' OR STATE_SHIP = 'MS' OR STATE_SHIP = 'MO' OR STATE_SHIP = 'MT' OR STATE_SHIP = 'NE' OR STATE_SHIP = 'NV' OR STATE_SHIP = 'NH' OR STATE_SHIP = 'NJ' OR STATE_SHIP = 'NM' OR STATE_SHIP = 'NY' OR STATE_SHIP = 'NC' OR STATE_SHIP = 'ND' OR STATE_SHIP = 'OH' OR STATE_SHIP = 'OK' OR STATE_SHIP = 'OR' OR STATE_SHIP = 'PA' OR STATE_SHIP = 'RI' OR STATE_SHIP = 'SC' OR STATE_SHIP = 'SD' OR STATE_SHIP = 'TN' OR STATE_SHIP = 'TX' OR STATE_SHIP = 'UT' OR STATE_SHIP = 'VT' OR STATE_SHIP = 'VA' OR STATE_SHIP = 'WA' OR STATE_SHIP = 'WV' OR STATE_SHIP = 'WI' OR STATE_SHIP = 'WY')

-- HIS
SELECT CUSTOMER, NAME_CUST_SHIP, COUNTRY_SHIP, ADDRESS1_SHIP, ADDRESS2_SHIP, ADDRESS3_SHIP, ADDRESS4_SHIP, ADDRESS5_SHIP, CITY_SHIP, STATE_SHIP FROM "ORDER_HIST_LINE"
WHERE COUNTRY_SHIP = ''
ORDER BY CUSTOMER ASC

-- HIS
UPDATE "ORDER_HIST_LINE"
SET COUNTRY_SHIP = 'USA'
WHERE CUSTOMER = '82769'

-- ADDITIONAL SHIP TO'S HOUSED IN: OE_MULTI_SHIP
SELECT * FROM "OE_MULTI_SHIP"
ORDER BY CUSTOMER ASC

UPDATE "OE_MULTI_SHIP"
SET SHIP_COUNTRY = 'USA'
WHERE (SHIP_STATE = 'AL' OR SHIP_STATE = 'AK' OR SHIP_STATE = 'AZ' OR SHIP_STATE = 'AR' OR SHIP_STATE = 'CA' OR SHIP_STATE = 'CO' OR SHIP_STATE = 'CT' OR SHIP_STATE = 'DE' OR SHIP_STATE = 'FL' OR SHIP_STATE = 'GA' OR SHIP_STATE = 'HI' OR SHIP_STATE = 'ID' OR SHIP_STATE = 'IL' OR SHIP_STATE = 'IN' OR SHIP_STATE = 'IA' OR SHIP_STATE = 'KS' OR SHIP_STATE = 'KY' OR SHIP_STATE = 'LA' OR SHIP_STATE = 'ME' OR SHIP_STATE = 'MD' OR SHIP_STATE = 'MA' OR SHIP_STATE = 'MI' OR SHIP_STATE = 'MN' OR SHIP_STATE = 'MS' OR SHIP_STATE = 'MO' OR SHIP_STATE = 'MT' OR SHIP_STATE = 'NE' OR SHIP_STATE = 'NV' OR SHIP_STATE = 'NH' OR SHIP_STATE = 'NJ' OR SHIP_STATE = 'NM' OR SHIP_STATE = 'NY' OR SHIP_STATE = 'NC' OR SHIP_STATE = 'ND' OR SHIP_STATE = 'OH' OR SHIP_STATE = 'OK' OR SHIP_STATE = 'OR' OR SHIP_STATE = 'PA' OR SHIP_STATE = 'RI' OR SHIP_STATE = 'SC' OR SHIP_STATE = 'SD' OR SHIP_STATE = 'TN' OR SHIP_STATE = 'TX' OR SHIP_STATE = 'UT' OR SHIP_STATE = 'VT' OR SHIP_STATE = 'VA' OR SHIP_STATE = 'WA' OR SHIP_STATE = 'WV' OR SHIP_STATE = 'WI' OR SHIP_STATE = 'WY')

-- ONGOING
SELECT * FROM "ORDER_SHIP_TO"
WHERE COUNTRY_SHIP = '' 
AND (RECORD_NO = '  C' OR RECORD_NO = '  B')
ORDER BY ORDER_NO DESC

SELECT * FROM "ORDER_HIST_LINE"
WHERE COUNTRY_SHIP = ''
ORDER BY CUSTOMER ASC

SELECT * FROM "ORDER_HIST_LINE"
WHERE COUNTRY_SHIP = 'USA' 
AND STATE_SHIP NOT IN ('AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DC', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY')
ORDER BY CUSTOMER ASC

UPDATE "ORDER_HIST_LINE"
SET STATE_SHIP = 'OR'
WHERE CUSTOMER = '82769'

-- SAVED QUERIES
SELECT * FROM "ORDER_SHIP_TO"
WHERE (RECORD_NO = '  C' OR RECORD_NO = '  B') 
AND (COUNTRY_SHIP = '' OR (COUNTRY_SHIP = 'USA' AND STATE_SHIP NOT IN ('AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DC', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY')))
ORDER BY CUSTOMER ASC

--UPDATE "ORDER_SHIP_TO"
--SET COUNTRY_SHIP = 'USA'
--WHERE STATE_SHIP = 'TX' AND CUSTOMER = 'T20121'

SELECT * FROM "ORDER_HIST_LINE"
--CUSTOMER, ADDRESS_1_SHIP, ADDRESS_2_SHIP, STATE_SHIP, COUNTRY_SHIP from "ORDER_SHIP_TO"
WHERE (COUNTRY_SHIP = 'USA' AND STATE_SHIP NOT IN ('AL', 'AK', 'AZ', 'AR', 'CA', 'CO', 'CT', 'DC', 'DE', 'FL', 'GA', 'HI', 'ID', 'IL', 'IN', 'IA', 'KS', 'KY', 'LA', 'ME', 'MD', 'MA', 'MI', 'MN', 'MS', 'MO', 'MT', 'NE', 'NV', 'NH', 'NJ', 'NM', 'NY', 'NC', 'ND', 'OH', 'OK', 'OR', 'PA', 'RI', 'SC', 'SD', 'TN', 'TX', 'UT', 'VT', 'VA', 'WA', 'WV', 'WI', 'WY'))
OR COUNTRY_SHIP = ''
ORDER BY CUSTOMER ASC

-- UPDATE CUSTOMER > SORT FOR INDUSTRY
SELECT * FROM "CUSTOMER_SALES"
WHERE REC = '2'

UPDATE "CUSTOMER_SALES"
SET C_SORT_1 = ""
WHERE REC = '2' AND (CUSTOMER = '')